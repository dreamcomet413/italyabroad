<tr>
    <td colspan="4"><h2 class="fLeft question"><%= @questions[params[:step].to_i]-%></h2></td>
  </tr>
<tr><td>&nbsp;</td></tr>
<tr><td>&nbsp;</td></tr>
<tr><td>&nbsp;</td></tr>
  <tr>
    <td colspan="4">

<% if item_options.present? %>
    <% width = (100/item_options.size.to_i).to_i %>
    <table class="items">
      <tr>
        <% item_options.each do |item| %>
            <td class="recWine" style="width: <%= width -%>%;">
              <%= unless params[:step].present?
                    image_tag("sommilier-image-#{item.upcase.gsub(" WINE", "").gsub(" ", "-")}.jpg", :height => "125", :width => "140")
                  else
                    item
                  end
                  -%>

            </td>
        <% end %>
      </tr>
      <tr>
        <%#= form_tag("/site/sommelier", :method => "post", :remote => true, :id => "new_search") do -%>
        <% item_options.each do |item| %>
            <td class="recWine" style="width: <%= width -%>%; height: 30px;">
              <%= radio_button :selected_option, "", "#{item}" %><br /></br /><%= item.gsub(" Wine", "") -%>
            </td>
        <% end %>
        <%= hidden_field_tag :step, step, :id => "step" -%>
        <%# end %>
      </tr>
    </table>
<% end %>
      <% if params[:step].present? %>
                <div class="fRight" style="margin-right: 12px; padding: 5px;">
                  <b>
                    <%= link_to "Go Back", "#", :id => "go_back" -%>
                  </b>
                </div>
            <% end %>
            </td>
          </tr>

<script type="text/javascript">
    $(".recWine input").click(function(){
        $.ajax({
            type: 'POST',
            url: "/site/sommelier",
            data: {selected_option: $(this).val(), step: $("#step").val()},
            cache: false,
            success: function(data){
//            alert(data)
                if ($(".question").length > 1){
                    $(".question").first().parent().parent().html("")
                }
            },
            error:function(xhr,ajaxOptions,thrownError){
                alert(xhr.status);
                alert(thrownError);
            }
        })
//      $("#new_search").submit()
    })

    $("#go_back").click(function(){
        if ("<%= params[:step]-%>" == "1"){
          window.location.href = "/site/sommelier"
        }
        else {
            $.ajax({
                type: 'POST',
                url: "/site/sommelier",
                data: {selected_option: "<%= params[:selected_option] -%>", step: "<%= params[:step].to_i - 1 -%>"},
                cache: false,
                success: function(data){
    //            alert(data)
                    if ($(".question").length > 1){
                        $(".question").first().parent().parent().html("")
                    }
                },
                error:function(xhr,ajaxOptions,thrownError){
                    alert(xhr.status);
                    alert(thrownError);
                }
            })
    //      $("#new_search").submit()
        }
        return false;
    })
</script>